CKEDITOR.dialog.add("cssanimMainDialog",function(e){"use strict";function t(e){if("#"===e.substr(0,1))return e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e),a=parseInt(t[2],10).toString(16),n=parseInt(t[3],10).toString(16),i=parseInt(t[4],10).toString(16);return"#"+((1===a.length?"0"+a:a)+(1===n.length?"0"+n:n)+(1===i.length?"0"+i:i))}function a(e,t){var a="";a+="<form>",a+='<div style=" overflow: auto; height: 350px; padding-bottom: 10px; margin-bottom: 10px;">',a+="<table>";var n,i;for(n=0;n<t.length;n+=1)a+="<tr>",a+='<td style="width:280px;">',a+=t[n].toUpperCase(),a+="</td>",a+='<td style="text-align:center; width:80px;">',i="",e.indexOf(t[n])>=0&&(i="checked=checked"),a+=' <input type="checkbox" name="tags" '+i+' value="'+t[n]+'">',a+="</td>",a+="</tr>";return a+="</table>",a+="</div>",a+="</form>"}function n(){var a="",n=e.config.highlightBGColor;e.config.highlightBGColor.indexOf("rgb")>=0&&(n=t(e.config.highlightBGColor));var i=e.config.customCssFilePath;return a+="<form>",a+='<fieldset style="border-radius:10px">',a+='<legend style="font-weight:bold;">'+l.HBS+"</legend>",a+='<table style="width:300px;">',a+="<tr>",a+='<td style="width:250px;">',a+=l.HBGC,a+="</td>",a+="<td>",a+='<input style="width:50px; height:25px; " type="color" name="HLBgColor" value="'+n+'"  onchange="CKEDITOR.plugins.cssanim.setHighLightBgColor(this.value)">',a+="</td>",a+="</tr>",a+="<tr>",a+="<td>",a+=l.HBW,a+="</td>",a+='<td style="padding:2px;">',a+='<input style="width:40px; border: 1px solid #ccc;" name="width" type="number" min="1" max="10"  onchange="CKEDITOR.plugins.cssanim.setHighLightBorder(this.value)"  value="'+parseInt(e.config.highlightBorder)+'"> px',a+="</td>",a+="</tr>",a+="</table>",a+="</fieldset>",a+="<br>",a+='<fieldset style="border-radius:10px">',a+='<legend style="font-weight:bold;">'+l.CustomCSS+"</legend>",a+='<table style="width:300px;">',a+="<tr>",a+='<td style="width:50px;">',a+=l.cssPath+"&nbsp;",a+="</td>",a+='<td style="width:250px;">',a+='<input type="text" style="width:400px; border: 1px solid #ccc;" name="cssName" value='+i+">",a+="</td>",a+="</tr>",a+="<tr>",a+='<td colspan="2" style="text-align:center; padding-top: 8px;color: tomato;">',a+=l.cssInfo,a+="</td>",a+="</tr>",a+="</table>",a+="</fieldset>",a+='<div id="cssResultsDiv" style="margin-top:10px; padding:5px; text-align: center; border: #ccc solid 1px; display:none;">',a+="test",a+="</div>",a+="</form>"}function i(t){var a,n,i,s=l.irrelevant,o=t.getContentElement("tab-parameters-box","parametersSettings").getElement().getElementsByTag("input");for(i=0;i<o.count();i+=1)if(n=o.getItem(i).getNameAtt(),"HLBgColor"===n){a=o.getItem(i).getValue();break}var g,r='<th style="border: 1px solid gray; text-align:center; padding:5px; font-weight:bold; background-color: lightgray;">',m='<td style="border: 1px solid gray; text-align:center; padding:5px;',d=CKEDITOR.plugins.cssanim.getAllAnimElem(e),c=l.noElements,b="";b+='<div style="width: 90%; height: 1px; background: grey; margin-left: auto;margin-right: auto;"></div>',b+='<p style="text-align: center; padding: 5px; color: grey; font-weight:bold;">',b+='<span style="color: LightSkyBlue; font-weight:bold;">'+l.animFromDef+"</span>",b+='<br><span style="color: cornflowerblue; font-weight:bold;">'+l.animPause+"</span>",b+='<br><span style="color: PaleGreen; font-weight:bold;">'+l.animFromCustom+"</span>",b+='<br><span style="color: orange; font-weight:bold;">'+l.animBoth+"</span>",b+='<br><span style="color: Red; font-weight:bold;">'+l.animUndef+"</span>",b+="<br>",b+="</p>",b+='<div style="width: 90%; height: 1px; background: grey; margin-left: auto;margin-right: auto;"></div>',b+='<p style="text-align: center; padding: 5px; color: grey; font-weight:bold;">',b+=l.dblClick,b+="</p>",b+='<div style="width: 90%; height: 1px; background: grey; margin-left: auto;margin-right: auto;margin-bottom: 10px;"></div>',b+='<div style=" width: 600px; overflow: auto; height: 400px;">',b+="<table>",b+="<tr>",b+=r+"Tag</th>",b+=r+"Id</th>",b+=r+"OnLoad</th>",b+=r+"OnClick</th>",b+=r+"OnOver</th>",b+=r+l.ral+"</th>",b+="</tr>";var h,u,p,v,f,C=0,A="azure;";for(f in d)d.hasOwnProperty(f)&&(v=d[f],s=l.irrelevant,g='">',C+=1,A="azure",h=v.elem.nodeName.toLowerCase(),e.config.allowedTags.indexOf(h)<0&&(A="MistyRose"),b+='<tr style="background-color:'+A+';" ',b+=" onmouseover=\"this.style.backgroundColor='"+a+"'; CKEDITOR.plugins.cssanim.runHighLightElemById('"+v.elem.id+"'); \"",b+=" onmouseout=\"this.style.backgroundColor='"+A+"'; CKEDITOR.plugins.cssanim.cleanHighlight();\"",b+=" ondblclick=\" CKEDITOR.plugins.cssanim.runAddAnimDialogById('"+v.elem.id+"')\"",b+=" >",b+=m+g,b+=v.elem.nodeName,b+="</td>",b+=m+g,b+=v.elem.id,b+="</td>",g='">',v.cds?(u=v.cds.replace("{animation:","").replace("}","").replace(";","").trim(),p=parseCSS3AnimationShorthand(u),s=v.ral?"YES":"NO",p.name&&(g="cssAnimPause"===p.name?' background-color:cornflowerblue;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsConflict&&t.availableAnimsObj.allAvailableAnimsConflict.indexOf(p.name)>=0?' background-color:orange;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCustom&&t.availableAnimsObj.allAvailableAnimsCustom.indexOf(p.name)>=0?' background-color:PaleGreen;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCssAnim&&t.availableAnimsObj.allAvailableAnimsCssAnim.indexOf(p.name)>=0?' background-color:LightSkyBlue;">':' background-color:Red;">'),b+=m+g):(p={},p.name="",b+=m+g),b+=p.name,b+="</td>",g='">',v.cdc?(v.cdc.indexOf("animation-play-state")>=0?p={name:"cssAnimPause",duration:null,timingFunction:"linear",delay:0,iterationCount:1,direction:"normal"}:(u=v.cdc.replace("{animation:","").replace("}","").replace(";","").trim(),p=parseCSS3AnimationShorthand(u)),p.name&&(g="cssAnimPause"===p.name?' background-color:cornflowerblue;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsConflict&&t.availableAnimsObj.allAvailableAnimsConflict.indexOf(p.name)>=0?' background-color:orange;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCustom&&t.availableAnimsObj.allAvailableAnimsCustom.indexOf(p.name)>=0?' background-color:PaleGreen;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCssAnim&&t.availableAnimsObj.allAvailableAnimsCssAnim.indexOf(p.name)>=0?' background-color:LightSkyBlue;">':' background-color:Red;">'),b+=m+g):(p={},p.name="",b+=m+g),b+=p.name,b+="</td>",g='">',v.cdo?(v.cdo.indexOf("animation-play-state")>=0?p={name:"cssAnimPause",duration:null,timingFunction:"linear",delay:0,iterationCount:1,direction:"normal"}:(u=v.cdo.replace("{animation:","").replace("}","").replace(";","").trim(),p=parseCSS3AnimationShorthand(u)),p.name&&(g="cssAnimPause"===p.name?' background-color:cornflowerblue;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsConflict&&t.availableAnimsObj.allAvailableAnimsConflict.indexOf(p.name)>=0?' background-color:orange;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCustom&&t.availableAnimsObj.allAvailableAnimsCustom.indexOf(p.name)>=0?' background-color:PaleGreen;">':t.availableAnimsObj&&t.availableAnimsObj.allAvailableAnimsCssAnim&&t.availableAnimsObj.allAvailableAnimsCssAnim.indexOf(p.name)>=0?' background-color:LightSkyBlue;">':' background-color:Red;">'),b+=m+g):(p={},p.name="",b+=m+g),b+=p.name,b+="</td>",g='">',b+=m+g,b+=s,b+="</td>",b+="</tr>");return C>0&&(b+="</table>",b+="</div>",b+='<div style="height: 6px;"></div>',c=b),c}var l=e.lang.cssanim;return{title:e.lang.cssanim.genProperties,minWidth:550,width:550,minHeight:250,height:250,resizable:CKEDITOR.DIALOG_RESIZE_NONE,contents:[{id:"tab-doc-animations",label:l.docAnim,elements:[{type:"html",id:"allAnimations",html:""}]},{id:"tab-allowed-tags",label:l.allowedTags,elements:[{type:"html",id:"allowedTags",allowedTags:null,html:"",setup:function(){this.allowedTags=e.config.allowedTags},cancel:function(){e.config.allowedTags=this.allowedTags;var t,a=this.getElement().getElementsByTag("input");for(t=0;t<a.count();t+=1)a.getItem(t).$.checked=e.config.allowedTags.indexOf(a.getItem(t).$.value)<0?!1:!0},commit:function(){var t,a=this.getElement().getElementsByTag("input");for(e.config.allowedTags=[],t=0;t<a.count();t+=1)a.getItem(t).$.checked&&e.config.allowedTags.push(a.getItem(t).$.value)}}]},{id:"tab-parameters-box",label:l.advSettings,elements:[{type:"html",id:"parametersSettings",html:"",bg:"",bw:0,pad:0,setup:function(){var e,t,a=this.getElement().getElementsByTag("input");for(t=0;t<a.count();t+=1)e=a.getItem(t).$.name,"HLBgColor"===e?this.bg=a.getItem(t).$.value:"width"===e&&(this.bw=a.getItem(t).$.value)},commit:function(){var t,a,n=this.getElement().getElementsByTag("input");for(a=0;a<n.count();a+=1)t=n.getItem(a).$.name,"HLBgColor"===t?e.config.highlightBGColor=n.getItem(a).$.value:"width"===t?e.config.highlightBorder=n.getItem(a).$.value+"px":"cssName"===t&&this.getDialog().initialCssFile!==n.getItem(a).$.value&&CKEDITOR.plugins.cssanim.getCustomCss(n.getItem(a).$.value)},cancel:function(){var t,a,n=this.getElement().getElementsByTag("input");for(a=0;a<n.count();a+=1)t=n.getItem(a).$.name,"HLBgColor"===t?(n.getItem(a).$.value=this.bg,e.config.highlightBGColor=this.bg):"width"===t&&(n.getItem(a).$.value=this.bw,e.config.highlightBorder=this.bw+"px")}}]}],onLoad:function(){CKEDITOR.plugins.cssanim.setCssAnimDialog(this),this.initialCssFile="";var t,l;t=this.getContentElement("tab-doc-animations","allAnimations").domId,l=document.getElementById(t),l.innerHTML=i(this),t=this.getContentElement("tab-allowed-tags","allowedTags").domId,l=document.getElementById(t),l.innerHTML=a(e.config.allowedTags,e.config.onLoadAllowedTags),t=this.getContentElement("tab-parameters-box","parametersSettings").domId,l=document.getElementById(t),l.innerHTML=n(),this.on("selectPage",function(t){var l,s,o;"tab-allowed-tags"===t.data.currentPage&&(l=t.sender.getContentElement("tab-allowed-tags","allowedTags"),l.commit()),"tab-doc-animations"===t.data.page?(l=t.sender.getContentElement("tab-doc-animations","allAnimations").domId,s=document.getElementById(l),s.innerHTML=i(this)):"tab-allowed-tags"===t.data.page?(l=t.sender.getContentElement("tab-allowed-tags","allowedTags").domId,s=document.getElementById(l),s.innerHTML=a(e.config.allowedTags,e.config.onLoadAllowedTags)):"tab-parameters-box"===t.data.page&&(o=t.sender.getContentElement("tab-parameters-box","parametersSettings"),l=o.domId,s=document.getElementById(l),s.innerHTML=n())})},onShow:function(){this.setupContent();var t=this.getContentElement("tab-parameters-box","parametersSettings"),a=t.domId,n=document.getElementById(a);e.config.customCssFilePath!==this.initialCssFile&&(CKEDITOR.plugins.cssanim.getCustomCss(n),this.initialCssFile=e.config.customCssFilePath),this.availableAnimsObj=CKEDITOR.plugins.cssanim.getAvailableAnims(),this.hidePage("tab-doc-animations"),this.showPage("tab-doc-animations"),this.selectPage("tab-doc-animations"),CKEDITOR.plugins.cssanim.cleanHighlight()},onOk:function(){this.commitContent(),CKEDITOR.plugins.cssanim.pendingChanges=[]},onCancel:function(){if(CKEDITOR.plugins.cssanim.managePending){var t,a;for(t=CKEDITOR.plugins.cssanim.pendingChanges.length-1;t>=0;t-=1)a=JSON.parse(CKEDITOR.plugins.cssanim.pendingChanges[t][1]),CKEDITOR.plugins.cssanim.restoreAnimOnElemById(CKEDITOR.plugins.cssanim.pendingChanges[t][0],a);CKEDITOR.plugins.cssanim.pendingChanges=[]}if(e.config.customCssFilePath!==this.initialCssFile){var n=this.getContentElement("tab-parameters-box","parametersSettings"),i=document.getElementById(n.domId),l=i.querySelector("#cssResultsDiv");l.parentElement.elements.cssName.value=this.initialCssFile.trim(),CKEDITOR.plugins.cssanim.getCustomCss(i)}this.foreach(function(e){e.cancel&&e.cancel.apply(e)})}}});